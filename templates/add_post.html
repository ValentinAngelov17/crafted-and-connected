{% extends 'base.html' %}
{% load static %}
{% block page_content %}
    <title>Crafted & Connected</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/all.min.css' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quando&display=swap" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <h1>Add a New Post</h1>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}

        <button type="submit">Add Post</button>
    </form>

    <script>
        // jQuery script to update subcategories based on selected category
        $(document).ready(function() {
            $('#id_category').change(function() {
                var categoryId = $(this).val();
                if (categoryId) {
                    $.ajax({
                        url: '{% url "load_subcategories" %}', // Add URL for your AJAX view
                        data: {
                            'category_id': categoryId
                        },
                        success: function(data) {
                            $("#id_subcategory").html(data);
                        }
                    });
                } else {
                    $("#id_subcategory").html('<option value="">Select a subcategory</option>');
                }
            });
        });
    </script>
{% endblock %}
