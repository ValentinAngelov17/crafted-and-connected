{% extends 'base.html' %}
{% load static %}
{% block page_content %}
    <title>Crafted & Connected</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/all.min.css' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quando&display=swap" rel="stylesheet">
    <div class="user-profile">
        <div><h1 style="font-family:  'Roboto Slab', serif;
            font-optical-sizing: auto;
            font-weight: 400;
            font-style: normal;">Профил</h1></div>
        <div>
            {% if user.profile_picture %}
                <img src="{{ request.user.profile_picture.url }}" alt="Profile Picture"
                     style="height: 150px; width: 150px; border-radius: 100px;">
            {% else %}
                <!-- Display a default image if the user hasn't uploaded a profile picture -->
                <img src="{% static 'images/wood.jpg' %}" alt="Default Profile Picture"
                     style="width: 200px; height: 200px;">
            {% endif %}

        </div>
        <div class="user-details">
            <p style="height: 20px;"><strong>Име:</strong> {{ user.first_name }}</p>
            <p><strong>Фамилия:</strong> {{ user.last_name }}</p>
            <p><strong>Последователи:</strong> {{ followers_count }}</p>
            <p><strong>Последвани: </strong>{{ following_count }}</p>
            <p><strong>Email:</strong> {{ user.email }}</p>
        </div>

        <div class="user-details" style="margin: 20px;"><p>Описание: {{ user.description }}</p></div>
        {% if request.user == user %}
            
            <div style="height: 40px; margin-bottom: 12px;">
                <a class="profile-buttons" href="{% url 'update_profile_picture' %}">Редактиране</a>
            </div>
            <div style="height: 40px;">
                <a href="{% url 'order_history' %}" class="profile-buttons"
                   style="width: 200px; font-size: 16px; margin: 40px 0;">История на поръчките</a>
            </div>
            <div>
                <form style="height: 40px; margin-bottom: 20px;" action="{% url 'logout' %}" method="post">
                    {% csrf_token %}
                    <button style="margin-bottom: 30px; margin-top: 0;" class="profile-buttons" type="submit">Изход</button>
                </form>
            </div>
        {% else %}
            <div class="buttons" style="margin-bottom: 20px;">
                <a class="after-login-buttons">Съобщение</a>
            </div>
            {% if not is_following %}
                <form method="post" action="{% url 'follow_user' user.id %}">
                    {% csrf_token %}
                    <button class="profile-buttons" type="submit" style="margin-bottom: 20px;">Последвай</button>
                </form>
            {% else %}
                <form method="post" action="{% url 'unfollow_user' user.id %}">
                    {% csrf_token %}
                    <button class="profile-buttons" type="submit" style="margin-bottom: 20px;">Отпоследвай</button>
                </form>
            {% endif %}
        {% endif %}
        <h2> {{ post_count }} Публикации</h2>
        <div class="post-grid">
            {% for post in posts %}
                <div class="post-item">
                    
                    <a href="{% url 'post_detail' post.id %}">
                        <img style="width: 200px; height: 200px;" src="{{ post.photos.url }}" alt="post photos"
                             class="img-fluid">
                    </a>
                </div>
            {% empty %}
                <p>No posts yet.</p>
            {% endfor %}
        </div>
    </div>

{% endblock %}
